---
title: Análisis del perfil de un gamer en UTEC, tendencias e influencia en su rendimiento académico
author: "Juan Diego Prochazka, Arturo Villar, Eddison Pinedo, Alexandro Chamochumbi, Angello Paretto"
date: '2022-11-25'
output:
  slidy_presentation: default
  ioslides_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(readr)
library(dplyr)
library(tidyverse)
library(stats4)
library(MASS)
library(survival)
library(distrMod)

DF <- read_csv("limpio_2.csv")

```

# Introducción

+ **Relevancia**

Nuestro estudio es relevante porque permite encontrar si la relación entre la preferencia en videojuegos de los alumnos y su perfil estudiantil. Con esta información podremos validar o rechazar algunas ideas o prejuicios alrededor de los videojuegos; por ejemplo, la idea de que jugar videojuegos lleva a un menor rendimiento.

+ **Objetivo del estudio**

Nuestro estudio busca recolectar datos del perfil universitario de los estudiantes y relacionarlo al uso de videojuegos. Nos enfocamos principalmente en la relación entre los videojuegos y el perfil académico, aunque consideramos otros factores.

+ **Planificación**
  
![Diagrama de Gantt](p1.jpg)

# Datos

+ **Proceso de recolección de datos**
  
Los datos se recolectaron a través de una encuesta de _Google Forms_ de que fue circulada por la universidad. También se aprovechó la presencialidad para conseguir encuestas que fueron incentivadas con un dulce en la Universidad durante el 27 y 28 de septiembre del 2022 en horas del día. No encontramos algún factor de influencia a partir de esta metodología.
Utilizamos _Google Forms_ porque es gratuita, permite la restricción de dominios de las variables (facilitando la limpieza) y facilita compartir la encuesta. Para analizar los datos en R, se descargaron las respuestas en un archivo de formato `.csv`.

## Población, muestra y muestreo 

+ Población de estudio: Alumnos de pregrado de UTEC.

+ Unidad muestral: Alumno.

+ Muestreo: Muestreo por conveniencia. Se hizo llegar la encuesta a estudiantes por medio digital que dieron su tiempo y 
Obtuvo una muestra cuyo tamaño es de `r nrow(DF)` observaciones.

+ Representatividad: Consideramos que la encuesta es representativa de la población de UTEC a pesar de que tenemos solo un total del `r round((nrow(DF)/3200)*100,2)`% del universo de alrededor de 3200 alumnos porque no encontramos ningún factor de influencia en la recolección de los datos.

# Variables de estudio

Tenemos 2 tipos de variables: 

Las variables de perfil del alumno que son `Sexo`, `Edad`, `Carrera`, `Ciclo`, `Creditos`, `Vive_solo`,`Estudio`,`Promedio` y `Afecta`. Estas nos permiten entender más o menos quién es el alumno.

Las variables de uso de videojuegos que son `Gasto`, `Costo`, `Frecuencia`, `Amigos`, `Frecuencia_amigos`, `Favorito`, `Horas_juego`, las variables que hacen referencia a los géneros preferidos y las que refieren a las plataformas usadas.

- Total: 37 variables.

- 13 numéricas

- 24 categóricas

## Limpieza de base de datos

36 de las variables necesitaban algún tipo de limpieza como lo eran:

- Nombres inadecuados o con un formato inadecuado (valores que pueden ser corregidos)
- Variables vacías o irrelevantes (NA)
- Cambios de tipo de variable (numeric o booleano)
- En código, eliminación de códigos duplicados.
- En plataforma y preferencia, se soluciono la multiplicidad de valores.

Además, se renombraron las columnas a nombres más convenientes y se eliminaron las que nos resultan innecesarias.

# Análisis descriptivo

## Sexo

Veamos cual es el porcentaje de representación de cada sexo:

```{r}
barplot( (table(DF$Sexo)/sum(!is.na(DF$Sexo)))*100
        ,cex.names = 0.6
        ,ylim = c(0,110)
        ,main = "Variable Sexo"
        ,axes = TRUE
        ,xlab = "Respuesta"
        ,ylab = "Porcentaje"
        )
```

Analicemos si, en promedio, alguno de los sexos gasta más que el otro en videojuegos:

```{r}
print(
DF %>%
  group_by(Sexo) %>%
  summarise_at(vars(Gasto), list(name = mean))
)
```
Podemos ver que en promedio las personas que se identifican como de Sexo masculino tienden a gastar mas dinero en promedio en videojuegos. Utilizaremos la mediana para poder corroborar si esto se debe a algún dato atípico.
```{r}
print(
DF %>%
  group_by(Sexo) %>%
  summarise_at(vars(Gasto), list(name = median))
)
```
Claramente no se debe exclusivamente a esto. Podria deberse a la menor representacion de las personas de sexo femenino en nuestros datos.

# Edad

Veamos cuál es nuestra distribución de edades

```{r}
hist(DF$Edad
     ,breaks = seq(10,35)
     ,main = "Edades"
     , ylab = "Frecuencia"
     , xlab = "Edad"
     )
```

Ahora veamos si hay alguna relación entre Edad y la mediana de las Horas_juego

```{r}
Edad_HorasPromedio = DF %>%
      group_by(Edad) %>%
      summarise(Mean = median(Horas_juego, na.rm = T))
barplot(pull(Edad_HorasPromedio[2],-1)[-12]
        ,names.arg = c('16','17','18','19','20','21','22','23','24','25','34')
        ,cex.names = 0.6
        ,main = "Mediana de horas de juego vs edad"
        )
```

Pareciera que las personas de alrededor de 22 años tienden a jugar más videojuegos.
Esto se refuerza con el promedio:

```{r}
Edad_HorasPromedio = DF %>%
      group_by(Edad) %>%
      summarise(Mean = mean(Horas_juego, na.rm = T))
barplot(pull(Edad_HorasPromedio[2],-1)[-12]
        ,names.arg = c('16','17','18','19','20','21','22','23','24','25','34')
        ,cex.names = 0.6
        ,main = "Promedio de horas de juego vs edad"
        )
```


# Géneros de juegos preferidos

Vamos a ver cuales son los géneros que los estudiantes más prefieren:
Aca veremos un gráfico de barras de las frecuencias de qué géneros fueron más preferidos:

```{r}
preferidos = c(sum(DF$Arcade),sum(DF$Aventura),sum(DF$Deportes_y_carreras),sum(DF$Casual),sum(DF$RPG),sum(DF$MOBA),sum(DF$Peleas),sum(DF$Plataformas),sum(DF$Sandbox),sum(DF$Shooter),sum(DF$Simulacion))
preferidos_labels = c('Arcade','Aventura','Deportes/Carreras','Casual','RPGs','MOBA','Peleas','Plataformas','Sandbox','Shooter','Simulacion')
barplot(preferidos
        ,names.arg = preferidos_labels
        , las = 2
        , cex.names = 0.6
        , main = 'Frecuencias de Preferencia de Géneros')
```

# Analisis Probabilistico

## Costo

La densidad del costo se ve asi:
```{r}
hist(DF$Costo,
     main="Histograma de Precios de Compra Incluyendo Ceros",
     ylab = "Densidad",
     xlab = "Costo del ultimo videojuego comprado",
     #breaks = 30,
     prob = T
     )
```
Hay dos interpretaciones que hemos tomado para esta variable: El caso _holistico_ En este caso suponemos que la variable se explica con un solo modelo simple, a diferencia del caso segmentado que propone que realmente estamo viendo la suma de tres modelos y el caso _segmentado_. Si bien el caso holistico se ajusta bien al modelo, creemos que el caso segmentado es una mejor descripcion de lo que realmente esta ocurriendo.

### Caso _Holistico_

En este caso suponemos que la variable se explica con una distribucion unica. Dada la forma de la variable es natural suponer que es una exponencial. La evidencia empirica, notablemente la media (`r round(mean(DF$Costo, na.rm=T),2)`) y la desviacion estandar (`r round(sd(DF$Costo, na.rm=T),2)`) parecen soportar esta tesis. Asumiendo que asi fuese podriamos decir que la variable es aproximadamente exponencial con parametro 0.02.

$$\mathbb{X} \sim \text{Exp}(0.02)$$


### Caso _Segmentado_

A pesar de lo investigado en el caso anterior, el costo presenta multiples "bultos" dentro de su forma exponencial. Ninguna de las variables conocidas tiene este comportamiento. Por lo tanto suponemos que la variable costo se compone de multiples distribuciones "simples" superpuestas.

Hay quienes no han comprado un juego pagado nunca, y por lo tanto habran marcado cero. Esto significa que S\. 0 como valor discreto tiene una probabilidad mayor que cero de "salir".

De una muestra con tamaño `r sum(!is.na(DF$Costo))` de observaciones que no son NA, hay `r sum(DF$Costo == 0, na.rm = TRUE)` que son cero. Esto significa que el cero tiene una probabilidad de `r round(sum(DF$Costo == 0, na.rm = TRUE)/sum(!is.na(DF$Costo)),2)` que es considerable.

Si eliminamos los ceros de nuestros datos eso nos deja con una distribucion que se ve asi:
```{r}
Costo_No_ceros = DF$Costo[DF$Costo != 0 & DF$Costo < 400 & !is.na(DF$Costo)]
hist(Costo_No_ceros,
  main="Histograma de Precios de Compra",
  ylab = "Densidad",
  xlab = "Precios de Compra",
  freq = TRUE,
  breaks = seq(0,300,by=10),
  xlim = c(0,300),
  #ylim = c(0,30)
)
abline(v=c(50,200),
       col="red",
       lwd=3
       )
text(x=c(0,110,215),y=c(20),c("Indie","AA", "AAA"))
```


"A ojo" vemos tres grupos de observaciones, unas en el rango de 0 hasta 100, otras de 100 hasta 200 y un ultimo grupo entre 200 y 300. Esto tiene sentido si pensamos que los juegos "indie" son considerablemente mas baratos, que los juegos AA estan alrededor de los \$40 (S\. ~160) y que los titulos AAA se encuentran a precios de ~ \$70 (~S.\ 280). Por lo tanto nuestra muestra en realidad es un conjunto que resulta de la union de observaciones en tres variables aleatorias. La variable categorica que los separa no fue recogida en el proceso de recoleccion de datos y esfuerzos para reconstruirla a partir de las que tenemos (en particular las referentes a los generos que juega) han sido infructuosos.

$$ \mathbb{C}_{total} = \mathbb{C_i} \cup \mathbb{C}_{AA} \cup \mathbb{C}_{AAA} $$

<!-- Dada la multiplicidad de grupos superpuestos en nuestros datos, resultaria muy dificil modelar los datos a partir de lo que hemos recolectado. Sin embargo, sabemos que nuestras observaciones provienen de una "muestra" de precios de videojuegos. Si asumimos que todos los videojuegos dentro de cada categoria tienen una probabilidad semejante de ser comprados, entonces un buen modelo para los precios de videojuegos en general podria servir para nuestras observaciones. Entendemos que esto podria perder informacion de los sesgos especificos de UTEC. -->

Para poder trabajar con estas observaciones vamos a hacer los cortes sugeridos en la grafica y trataremos de modelar cada variable por separado. Sabemos que no podemos garantizar que las obsevaciones realmente pertenezcan a cada grupo, pero no tenemos otra forma trabajarlas.

```{r}
Costos_Indie = Costo_No_ceros[Costo_No_ceros <= 50]
Costos_AA = Costo_No_ceros[Costo_No_ceros > 50 & Costo_No_ceros <= 200]
Costos_AAA = Costo_No_ceros[Costo_No_ceros > 200]
```

Solo separando las observaciones ya podemos recolectar algunos datos interesantes. Si lo que estamos asumiendo respecto a las categorias es cierto, entonces el `r round((length(Costos_Indie)/length(DF$Costo[!is.na(DF$Costo)]))*100,2)`% de las observaciones son indie, el `r round((length(Costos_AA)/length(DF$Costo[!is.na(DF$Costo)]))*100,2)`% son AA y solo el `r round((length(Costos_AAA)/length(DF$Costo[!is.na(DF$Costo)]))*100,2)`% son AAA. Vale la pena recordar que hay un `r round(100*(sum(DF$Costo == 0, na.rm = TRUE)/sum(!is.na(DF$Costo))),2)`% de probabilidad de que sea cero.

```{r}
par(mfrow=c(1,3))
hist(Costos_Indie,
     breaks=5,
     main = "Indie"
     )
max(Costos_AA)
min(Costos_AA)
hist(Costos_AA,
     breaks=seq(50, 200, 30),
     main = "AA"
     )
hist(Costos_AAA,
     breaks=5,
     main = "AAA"
     )
```
Los datos que corresponden a los videojuegos Indie no se comportan de forma normal dado que al normalizarlos no tienen las proporciones adecuadas, ni de forma poisson por la relacion que hay entre la media y la desviacion estandar ($sd(\mathbb{X} ) \simeq media(\mathbb{X})$ ). Tampoco son exponenciales dado que la forma no es la apropiada y la media y desviacion estandar no cuadran. Sin embargo, dado que el rango es desde `r min(Costos_Indie)` hasta `r max(Costos_Indie)` la media esperada para una Uniforme seria de `r round((max(Costos_Indie)+min(Costos_Indie))/2,2)` y la desviacion estandar esperada seria de `r round(sqrt(((max(Costos_Indie)-min(Costos_Indie))^2)/12),2)`. Ambos descriptores se parecen a los observados (sd = `r round(sd(Costos_Indie),2)`, media = `r round(mean(Costos_Indie),2)`) asi que la variable que mas se asemeja dentro de las estudiadas es la Uniforme, a pesar del sesgo a la izquierda que presenta. Lo mismo se cumple para los costos de AA y AAA.Esto significa que nuestro modelo quedaria asi:

Existe T tal que
```{r}
min(Costos_AA)
max(Costos_AA)
```
$$ 
 \mathbb{T} =      \begin{cases}
     \text{Gratis} \quad \text{con probabilidad } 0.29 \\
     \text{Indie} \quad \text{con probabilidad } 0.42 \\
     \text{AA} \quad \text{con probabilidad } 0.26 \\
     \text{AAA} \quad \text{con probabilidad } 0.02 \\
     \end{cases} \\
$$
Y existe X tal que:
$$
     \\
\mathbb{X} \sim 
     \begin{cases}
     \mathbf{0}, \qquad \qquad \qquad \qquad \mathbb{T} = \text{Gratis} \\
     \mathbf{Unif(4,100)}, \qquad \quad \mathbb{T} = \text{Indie} \\
     \mathbf{Unif(55,200)}, \qquad \mathbb{T} = \text{AA} \\
     \mathbf{Unif(229,280)}, \qquad \mathbb{T} = \text{AAA} \\
     \end{cases} 
$$
Creemos que esto se debe a que los Utecsinos eligen videojuegos baratos exponencialmente mas que videojuegos caros, y que una ves han decidido en que categoria quieren tener un videojuego el precio no es un factor tan importante. Esto explica por que la variable _holistica_ se ajusta a un modelo exponencial.

# Genero de juego

Densidad de los generos se ven asi:

```{r}
DF$Cuantos_Generos = DF$Arcade + DF$Aventura + DF$Deportes_y_carreras + DF$Estrategia + DF$Casual + DF$RPG + DF$MOBA + DF$Shooter + DF$Simulacion + DF$Peleas + DF$Plataformas + DF$Sandbox
hist(DF$Cuantos_Generos,
     main="Histograma de cuantos generos prefieren",
     ylab = "Densidad",
     xlab = "Número de generos que gustan",
     prob = T
     )

```

Consideremos que queremos elegir 20 estudiantes al azar, considerando que en UTEC las aulas hay salones de 20 estudiantes. Planteamos como caso de éxito el hecho de que los estudiantes elegidos les guste menor o igual de 3 géneros de juego, ya que de acuerdo a nuestra muestra, les gusta pocos géneros de juego por lo general.
La probabilidad de que les guste menos o igual a 3 géneros de juego, para nuestro caso sería de 85/202, equivalente a 0.42 aproximadamente. Entonces el Modelo Binomial se vería de la siguiente manera:

X -> número de estudiantes que les gusta 3 a menos géneros de juegos en una aula de 20 alumnos

X∼Bin(202,0.42)

n -> número de muestras (20 encuestados)

p -> probabilidad de que la persona seleccionada le guste 3 a menos géneros de juegos es (85/202)

Ejemplo: La probabilidad de que 5 alumnos (cantidad de personas en un grupo de trabajo por lo general en los cursos) en un aula le guste 3 a menos géneros de juegos.
Tomamos en cuenta este análisis saber que probable sería tener un grupo en un curso y saber a todos los integrantes del grupo si les gusta por lo general la misma cantidad de géneros de juegos, usamos una distribución negativa binomial.

```{r}
r <- 5
p <- 0.42
n <- 20 - r
pDB <- dnbinom(x = n, size = r, prob = p)
data.frame(x = 0:17, prob = dnbinom(x = 0:17, size = r, prob = p)) %>%
  mutate(Failures = ifelse(x == n, n, "otro")) %>%
ggplot(aes(x = factor(x), y = prob, fill = Failures)) +
  geom_col() +
  geom_text(
    aes(label = round(prob,3), y = prob + 0.01),
    position = position_dodge(0.5),
    size = 2.5,
    vjust = 1
  ) +
  labs(title = "Probabilidad cuando r es 5, Exito cuando x es 20 Intentos", 
       x = "Intentos fallidos cuando: (x - r)",
       y = "Probabilidad de exito")
``` 

De la gráfica obtenemos que lo más probable es que se presenten 5 intentos fallidos con un porcentaje de 10,8%, es un número de intentos fallidos mediano ya que un 42% de alumnos les gusta pocos géneros de juego.



# Bibliografía
Mendenhall, W., Beaver, R., & Beaver, B. (2014). Introduccion a la Probabilidad y Estadistica (14a ed.). Cengage Learning Editores S.A. de C.V.

Peng, R. D. (2014, febrero 25). R programming for data science. Leanpub. https://leanpub.com/rprogramming

Peng, R. D. (2015, abril 27). Exploratory data analysis with R. Leanpub. https://leanpub.com/exdata

Ross, S. M. (2021). Introduction to probability and statistics for engineers and scientists (6a ed.). Academic Press.




